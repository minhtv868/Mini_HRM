@using Web.Application.Features.Finance.MessageTemplates.DTOs

@model Tuple<PaginatedResult<MessageTemplateGetPageDto>, PagingInput, short?>
@{
    Layout = null;
}
<table id="sticky-table" class="main-table table table-striped table-hover mb-0">
    <thead class="text-black">
        <tr>
            <th class="pt-1 pb-1 no-border" colspan="8">
                <div class="row flex-between-center">
                    <div class="col-auto col-sm-auto d-flex align-items-center pe-0">
                        <h6 class="mb-0 text-nowrap total-rows fw-semi-bold ps-1">Tìm thấy <span class="text-danger">@((Model == null || Model.Item1.TotalCount <= 0) ? "0" : Model.Item1.TotalCount.NumberFormat())</span> bản ghi</h6>
                    </div>
                    <div class="col-auto text-end ps-0 justify-content-end">
                        <div class="d-flex align-items-center" id="table-replace-element">
                            <div class="bulk-select-actions d-none">
                                <form method="post"
                                      data-ajax="true"
                                      data-ajax-url="@Url.Page(pageName: "Index", pageHandler: "BulkActions")"
                                      data-ajax-method="post"
                                      data-ajax-begin="onBegin(this)"
                                      data-ajax-success="onSuccessed(this, xhr, true)">
                                    <div class="d-flex">
                                        <button onclick="return confirm('Xác nhận xóa mẫu tin đã chọn !')" class="btn btn-sm btn-falcon-default rounded-pill m-button-hover-warning ms-2" type="submit">
                                            <i class="far fa-trash-alt text-danger"></i>
                                            <span class="d-none d-md-inline-block ms-1">Xóa</span>
                                        </button>
                                        <input class="ChkActionIds" type="hidden" name="ChkActionIds" />
                                    </div>
                                </form>
                            </div>
                            <div class="bulk-select-replace-element d-flex align-items-center">
                                <button class="btn btn-primary no-focus ms-2" type="button"
                                        data-modal="modal-lg"
                                        onclick="return modalGet(this, '@Url.Page(pageName: "Create",values: new { SiteId = Model.Item3}) ', 'Thêm mẫu tin')"
                                        title="Thêm mẫu tin">
                                    <i class="fas fa-plus"></i>
                                    <span class="d-none d-sm-inline-block ms-1">Thêm</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </th>
        </tr>
        <tr>
            
            <th class="px-1 text-center">STT</th>
            <th class="align-middle text-nowrap text-center">Tên</th>
            <th class="align-middle text-nowrap text-center">Gửi từ</th>
            <th class="align-middle text-nowrap text-center">Tiêu đề</th>
            <th class="align-middle text-nowrap text-center">Hình thức gửi</th>
            <th class="align-middle text-nowrap text-center">Thời gian</th>
            <th class="align-middle col-sm-1 text-center ">Thao tác</th>
            <th class="fs-0 text-nowrap pe-3">
                <div class="form-check mb-0">
                    <input class="form-check-input" type="checkbox" />
                </div>
            </th>
        </tr>
    </thead>
    <tbody>
        @if (Model.Item1.Data != null && Model.Item1.Data.Any())
        {
            int stt = (Model.Item1.CurrentPage - 1) * Model.Item1.PageSize;
            @foreach (var item in Model.Item1.Data)
            {
                stt++;
                <tr id="@item.MessageTemplateId" class="align-middle">
                    <td style="width:5%; text-align:center">@stt</td>
                    <td class="text-nowrap" style="max-width:250px">
                        <span class="mb-0 fw-semi-bold text-wrap">@item.MessageName</span>
                    </td>
                    <td class="text-nowrap" style="max-width:150px">
                        <span class="mb-0  text-wrap">@item.SendFrom</span>
                    </td>
                    <td class="text-nowrap" style="max-width:300px">
                        <span class="mb-0 text-wrap">@item.Title</span>
                    </td>
                    <td class="text-nowrap">
                        <span class="mb-0 text-wrap">@item.SendMethod</span>
                    </td>
                    <td class="align-middle text-nowrap text-center" style="max-width:150px">
                        <small class="mb-0 fs--1" title="Người tạo">
                            <i class="fas fa-user-plus text-500 fa-sm"></i> <span class="mb-0" title="Người tạo">@Html.DisplayFor(modelItem => @item.CrUser)</span>
                        </small><br />
                        <small class="mb-0 fs--1 " title="Thời gian tạo: @item.CrDateTime.ToStringFormat()">
                            <span class="mb-0" style="padding-left:7px">@item.CrDateTime.ToStringFormat("dd/MM/yyyy HH:mm")</span>
                        </small> <br />
                       
                    </td>
                   
                    <td class="align-middle white-space-nowrap text-center pe-3">
                        <button class="btn btn-link p-0 ms-1" type="button"
                                data-modal="modal-lg"
                                onclick="return modalGet(this, '@Url.Page(pageName:"Edit", values: new { id = item.MessageTemplateId })', 'Cập nhật mẫu tin')"
                                title="Cập nhật mẫu tin">
                            <i class="far fa-edit"></i>
                        </button>
                        <a href="javascript:void(0)" class="btn btn-link p-0 ms-1"
                           data-ajax="true"
                           data-ajax-url="@Url.Page(pageName: "Index", pageHandler: "Delete", values: new { id = item.MessageTemplateId })"
                           data-ajax-method="post"
                           data-ajax-begin="setRequestHeader(this, xhr)"
                           data-ajax-success="onSuccessed(this, xhr, false, true)"
                           data-ajax-confirm="Xác nhận xóa mẫu tin đã chọn"
                           title="Xóa mẫu tin">
                            <i class="far fa-trash-alt text-danger"></i>
                        </a>
                    </td>
                    <td class="align-middle py-3 text-nowrap" style="width:10px">
                        <div class="form-check mb-0">
                            <input class="form-check-input row-checkbox" type="checkbox" name="ChkActionIds" value="@item.MessageTemplateId" />
                        </div>
                    </td>
                </tr>
            }
        }
        else
        {
            <tr class="align-middle text-warning fs--1 not-found text-center">
                <td colspan="8">Chưa có dữ liệu</td>
            </tr>
        }
    </tbody>
</table>
@await Html.PartialAsync("_PaginationPartial", Model.Item2)